{% import 'form.html.twig' as form %}

<div class="row">
    <div class="form-group needed col-md-6 col-12">
        {% set requester = purchaseRequest.requester ?? app.user %}
        {{ form.select('requester', 'Demandeur', true, {
            items: {(requester.id ?? '' ): (requester.username ?? '')},
            disabled: true,
        }) }}
    </div>
    <div class="form-group col-md-6 col-12">
        {% set defaultStatus = purchaseRequest.id ? null : statuses|filter((status) => status.defaultForCategory)|first %}
        {% set selectedStatusId = (purchaseRequest.id ? purchaseRequest.status.id : (defaultStatus ? defaultStatus : statuses|first )).id %}

        {{ form.select('status', 'Statut', true, {
            multiple: false,
            inputClass: 'needs-default',
            additionalAttributes: [{
                name: 'data-init',
                value: selectedStatusId,
            }],
            search: false,
            type: '',
            disabled: false,
            items: statuses|map((status) => ({
                label: status.nom,
                value: status.id,
                order: status.displayOrder,
                selected: status.id == selectedStatusId,
            })),
        }) }}
    </div>
    <div class="form-group col-12 col-md-6">
        {{ form.select('supplier', 'Fournisseur', false, {
            type: 'provider',
            multiple: false,
            items: {(purchaseRequest.supplier.id ?? '' ): (purchaseRequest.supplier.nom ?? '')}
        }) }}
    </div>
</div>
<div class="row">
    <div class="form-group col-md-6 col-12">
        {{ form.wysiwyg('comment', 'Commentaire', false, purchaseRequest.comment ) }}
    </div>
    <div class="form-group col-md-6 col-12">
        {% include 'attachment/attachment.html.twig' with {
            'isNew' : false,
            'attachments': purchaseRequest.attachments
        } %}
    </div>
</div>
