{% extends 'layout.html.twig' %}

{% block title %}<a href="{{ path('settings_index') }}">Param√©trage</a> | <span id="page-title" class="text-regular">Chargement</span>{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    {{ encore_entry_link_tags('settings') }}
{% endblock %}

{% block page_content %}
    <div class="settings">
        <aside class="wii-box">
            {% for key, label in parent.menus %}
                {% if label is iterable %}
                    <a href="{{ path('settings_item', {category, menu: selected}) }}" class="settings-item">
                        {{ label.label }}
                    </a>
                {% else %}
                    <div class="settings-item {{ key == selected ? 'selected' }}" data-menu="{{ key }}">
                        {{ label }}
                    </div>
                {% endif %}
            {% endfor %}
        </aside>

        <main>
            {% for key, label in parent.menus %}
                {% if label is not iterable %}
                    <div class="wii-box {{ key != selected ? 'd-none' }}"
                         data-path="{{ category }}_{{ submenu ? menu : key }}{{ submenu ? '_' ~ key : '' }}"
                         data-menu="{{ key }}">
                        <div class="header wii-title">{{ label }}</div>
                        <div class="content focus-shadow">
                            {% include [path ~ key ~ '.html.twig', 'settings/todo.html.twig'] with {
                                page: path ~ key ~ '.html.twig'
                            } | merge(values[category][key] ?? []) %}
                        </div>
                    </div>
                {% endif %}
            {% endfor %}

            <div class="save">
                <button class="btn btn-success save-settings">Enregistrer</button>
            </div>
        </main>
    </div>

    <input type="hidden" id="settings" value="{{ constant('App\\Controller\\SettingsController::SETTINGS') | json_encode }}">
    <input type="hidden" id="category" value="{{ category }}">
    <input type="hidden" id="menu" value="{{ menu }}">
    <input type="hidden" id="submenu" value="{{ submenu }}">
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {{ encore_entry_script_tags('settings') }}
{% endblock %}
