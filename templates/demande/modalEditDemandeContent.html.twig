<div class="form-group">
    <label for="utilisateur">Demandeur</label>
    <select disabled class="form-control select2 data" name="demandeur">
        <option selected value="{{demande.utilisateur.id}}">{{ demande.utilisateur.username }}</option>
    </select>
</div>

<div class="form-group w-100">
    <label for="destination">Destination</label>
    <select name="destination" class="form-control ajax-autocomplete-location-edit data ">
        {% if demande.destination is defined and demande.destination != null %}
            <option value="{{demande.destination.id}}" selected>{{demande.destination.label}}</option>
        {% endif %}
    </select>
</div>

{% if demande.filled %}

<div class="form-group">
    <label for="typeEdit">Type</label>
    <select class="form-control data" name="type" id="typeEdit"
            disabled class="form-control data d-block" disabled>
        {% set selected = demande.type is null ? 'selected' : '' %}
        <option {{ selected }} value=''> </option>

        {% for type in typeChampsLibres %}
            {% set selected = '' %}
            {% if demande.type is not null %}{% set selected = demande.type.id == type.typeId ? 'selected' : '' %}{% endif %}
            <option {{ selected }} value="{{type.typeId}}">{{type.typeLabel}}</option>
        {% endfor %}
    </select>
</div>

<!-- CHAMPS LIBRES -->
<span class="toggle-collapsible expanded">Champs libres</span>
<div class="collapsible expanded free-fields-container mb-2">
    {% include 'free_field/freeFieldsViewing.html.twig' with {
        freeFields: demande.type is not null and freeFieldsGroupedByTypes[demande.type.id] is defined ? freeFieldsGroupedByTypes[demande.type.id] : [],
        freeFieldValues: demande.freeFields,
        colType: 'col-md-4 col-12',
        requiredType: 'requiredEdit',
        actionType: 'edit'
    } %}
</div>
{% else %}
    {% set uniqueType = types|length == 1 %}
    <div class="form-group">
        <label for="type">Type*</label>
        <select name="type" class="form-control data d-block type needed
                            {{ uniqueType ? 'needs-default' }}"
                onclick="typeChoice($(this))"
                onchange="toggleRequiredChampsLibres($(this), 'edit')"
            {{ uniqueType ? 'disabled' }}
            {{ uniqueType ? ('data-init="' ~ (types|first).id ~ '"')|raw }}>
            {% if not uniqueType %}
                <option value="">Type Ã  choisir...</option>
                {% for type in types %}
                    <option value="{{ type.id }}">{{ type.label }}</option>
                {% endfor %}
            {% else %}
                {% set typeToDisplay = types|first %}
                <option selected value={{ typeToDisplay.id }}>{{ typeToDisplay.label }}</option>
            {% endif %}
        </select>
    </div>

    <!-- CHAMPS LIBRES -->
    <span class="toggle-collapsible expanded">Champs libres</span>
    <div class="collapsible expanded free-fields-container mb-2">
        {% for type in typeChampsLibres %}
            <div class="d-none"
                 data-type="{{ type.typeId }}">
                {% include 'free_field/freeFieldsViewing.html.twig' with {
                    freeFields: type.champsLibres,
                    freeFieldValues: [],
                    colType: 'col-12',
                    requiredType: 'requiredEdit',
                    actionType: 'edit',
                    disabledNeeded: true
                } %}
            </div>
        {% endfor %}
    </div>
{% endif %}
<div class="form-group">
    <label for="commentaire" >Commentaire</label>
    <input id="commentaire" class="form-control data" name="commentaire" type="hidden" value="{{demande.commentaire}}" >
    <div class="editor-container-edit" value="{{demande.commentaire}}"> {{demande.commentaire|raw}}
    </div>
</div>
