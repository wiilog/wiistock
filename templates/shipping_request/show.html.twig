{% extends 'layout.html.twig' %}

{% block title %}Demande | {{ trans('Expédition', 'Général', 'Expédition', false) }} | Détails{% endblock %}

{% block title_tooltip %}Demande | Expédition | Détails{% endblock %}

{% block page_filter %}

{% endblock %}

{% set hasRightToCreate = hasRight(constant('App\\Entity\\Menu::DEM'), constant('App\\Entity\\Action::CREATE')) and hasRight(constant('App\\Entity\\Menu::DEM'), constant('App\\Entity\\Action::CREATE_SHIPPING')) %}
{% set hasRightToExport = hasRight(constant('App\\Entity\\Menu::DEM'), constant('App\\Entity\\Action::EXPORT')) %}

{% set hasRightEdit = hasRight(constant('App\\Entity\\Menu::DEM'), constant('App\\Entity\\Action::EDIT')) %}
{% set hasRightDelete = hasRight(constant('App\\Entity\\Menu::DEM'), constant('App\\Entity\\Action::DELETE')) %}


{% block page_content %}

    <div class="mb-4 ra-container d-flex justify-content-center align-content-center">
        <div class="row wii-column w-100">
            <div class="col-md-4 col-12">
                <div class="wii-box">
                    <div class="d-flex align-items-center mr-3">
                        <div class="mx-2">
                            <div class="dropdown dropright">
                                <div class="d-flex pointer" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <img alt="Actions" src="{{ asset('svg/dotsblack.svg') }}" height="20px" width="8px">
                                </div>
                                <div class="dropdown-menu dropdown-follow-gt pointer">
                                    {% if hasRightEdit %}
                                        <a data-id='{{ shipping.id }}'
                                           data-target='#modalEditDispatch'
                                           data-toggle='modal'
                                           onclick="/*editRow($(this), Routing.generate('dispatch_edit_api', true), $('#modalEditDispatch'), $('#submitEditDispatch'), false, initDatePickers)*/"
                                           class="dropdown-item pointer">
                                            <i class="fa fa-pen mr-2"></i>
                                            {{ trans('Général', null, 'Modale', 'Modifier') }}
                                        </a>
                                    {% endif %}
                                    {% if hasRightDelete %}
                                        <a href="" data-id='{{ shipping.id }}' data-target='#modalDeleteDispatch' data-toggle='modal'
                                           class="dropdown-item d-flex align-items-center">
                                            <span class="wii-icon wii-icon-trash-black mr-2"></span>
                                            {{ trans('Général', null, 'Modale', 'Supprimer') }}
                                        </a>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <div class="d-flex py-2 w-100 justify-content-between">
                            <div class="d-flex align-items-center">
                                <div class="d-flex flex-column">
                                    <span class="wii-title">{{ trans('Demande', 'Expédition', null, 'Expédition') }}</span>
                                    <span class="wii-small-text">
                                    {{ shipping.id }}
                                </span>
                                </div>
                            </div>
                            <div class="d-flex align-items-center justify-content-end">
                            <span class="wii-field-name">
                                {{ shipping.customerName }}
                            </span>
                            </div>
                        </div>
                    </div>
                    <div class="content bordered p-0">
                        <div class="content history-container p-0">
                            <div class="d-flex align-items-center justify-content-center p-3">
                                <div class="spinner-border text-primary" role="status"></div>
                                <span class="ml-3">Génération de l'historique en cours</span>
                            </div>
                        </div>
                    </div>

                    <div class="wii-section-title pt-0">
                        <i class="wii-icon wii-icon-info wii-icon-15px-primary mr-2"></i>
                        Informations
                    </div>
                    <div class="content">
                        <div class="d-flex mb-2">
                            <label class="box-item ml-3">
                                <span class="wii-field-name">N° commande client</span>
                                <span class="wii-body-text">{{ shipping.trackingNumber ? shipping.trackingNumber : '-' }}</span>
                            </label>
                        </div>
                        <div class="row">
                            <div class="col-12 col-md-6 d-flex mb-2">
                                <label class="box-item ml-3">
                                    <span class="wii-field-name">Livraison à titre gracieux</span>
                                    <span class="wii-body-text">{{ shipping.freeDelivery == 1 ?'Oui' : 'Non' }}</span>
                                </label>
                            </div>
                            <div class="col-12 col-md-6 d-flex mb-2">
                                <label class="box-item ml-3">
                                    <span class="wii-field-name">Article(s) conforme(s)</span>
                                    <span class="wii-body-text">{{ shipping.compliantArticles == 1 ?'Oui' : 'Non' }}</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="wii-section-title pt-0">
                        <i class="wii-icon wii-icon-user wii-icon-15px-primary mr-2"></i>
                        Destinataire
                    </div>
                    <div class="content">
                        <div class="row">
                            <div class="col-12 col-md-6 d-flex align-items-center mb-2">
                                <i class="wii-icon wii-icon-user wii-icon-20px-primary mr-2"></i>
                                <label class="box-item ml-3">
                                    <span class="wii-field-name">Client</span>
                                    <span class="wii-body-text">{{ shipping.customerName ?? '-' }}</span>
                                </label>
                            </div>
                            <div class="col-12 col-md-6 d-flex align-items-center mb-2">
                                <i class="wii-icon wii-icon-phone wii-icon-20px-primary mr-2"></i>
                                <label class="box-item ml-3">
                                    <span class="wii-field-name">Téléphone</span>
                                    <span class="wii-body-text">{{ shipping.customerPhone ?? '-'}}</span>
                                </label>
                            </div>
                            <div class="col-12 col-md-6 d-flex align-items-center mb-2">
                                <i class="wii-icon wii-icon-user wii-icon-20px-primary mr-2"></i>
                                <label class="box-item ml-3">
                                    <span class="wii-field-name">À l'attention de </span>
                                    <span class="wii-body-text">{{ shipping.customerName ?? '-' }}</span>
                                </label>
                            </div>
                            <div class="col-12 col-md-6 d-flex align-items-center mb-2">
                                <i class="wii-icon wii-icon- wii-icon-20px-primary mr-2"></i>
                                <label class="box-item ml-3">
                                    <span class="wii-field-name">Livraison à titre gracieux</span>
                                    <span class="wii-body-text">{{ shipping.freeDelivery == 1 ?'Oui' : 'Non' }}</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="content comment-container">
                    <div class="wii-subtitle">{{ trans('Général', null, 'Modale', 'Commentaire') }}</div>
                    {% if shipping.comment != '<p><br></p>' %}
                        <div class="ql-editor">
                            {{ shipping.comment | raw }}
                        </div>
                    {% else %}
                        -
                    {% endif %}
                </div>


            </div>
        </div>
    </div>
    </div>

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('js/pages/shipping.js') }}?v={{ web_version }}"></script>
{% endblock %}
