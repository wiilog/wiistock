<div class="row">
    {% set canEditFully = hasRight(constant('App\\Entity\\Menu::TRACA'), constant('App\\Entity\\Action::FULLY_EDIT_TRACKING_MOVEMENTS')) %}
    <div class="form-group col-md-6 col-12">
        <label for="datetime">Date*</label>
        <input type="datetime-local"
               class="form-control w-100 data"
               name="date"
               title="Date"
            {{ not canEditFully ? 'disabled' }}
               value="{{ mvt.datetime|date('Y-m-d\\TH:i') }}"/>
    </div>

    <div class="form-group col-md-6 col-12">
        <label for="operator">Opérateur*</label>
        <select name="operator"
                title="Opérateur"
                class="form-control ajax-autocomplete-user-edit data needed operator w-100">
            {% if mvt.operateur %}
                <option value="{{ mvt.operateur.id }}">{{ mvt.operateur.username }}</option>>
            {% endif %}
        </select>
    </div>

    <div class="form-group col-md-6 col-12">
        {% set pack = mvt.pack %}
        {% set code = pack ? pack.code %}
        <label title="Colis">{{ "mouvement de traçabilité.Colis"|trans }}*</label>
        <input type="text"
               title="Colis"
               class="form-control w-100 data"
               name="pack"
            {{ not canEditFully ? 'disabled' }}
               value="{{ code }}">
    </div>

    <div class="form-group col-md-6 col-12">
        {% set hasEmptyRoundRight = hasRight(constant('App\\Entity\\Menu::TRACA'), constant('App\\Entity\\Action::EMPTY_ROUND')) %}
        <label for="type">Action*</label>
        <select class="form-control data needed w-100"
                id="type"
                name="type"
                {{ not canEditFully ? 'disabled' }}
                onchange="switchMvtCreationType($(this))">
            <option disabled selected></option>
            {% for statut in statuts %}
                {% if statut.nom != constant('App\\Entity\\TrackingMovement::TYPE_UNGROUP')
                    and statut.nom != constant('App\\Entity\\TrackingMovement::TYPE_PRISE_DEPOSE')
                    and statut.nom != constant('App\\Entity\\TrackingMovement::TYPE_GROUP')
                    and statut.nom != constant('App\\Entity\\TrackingMovement::TYPE_EMPTY_ROUND') %}
                    <option class="{{ statut.nom == constant('App\\Entity\\TrackingMovement::TYPE_EMPTY_ROUND') and not hasEmptyRoundRight ? 'd-none' }}"
                            value="{{ statut.id }}"
                            {{ mvt.type.id == statut.id ? 'selected' }}>
                        {{ statut.nom }}
                    </option>
                {% endif %}
            {% endfor %}
        </select>
    </div>

    <div class="form-group col-md-6 col-12">
        <label class="my-auto mr-2">Emplacement*</label>
        <select name='location' data-s2='location' class='data form-control w-100' {{ not canEditFully ? 'disabled' }} required>
            {% if mvt.emplacement is not null %}
                <option value="{{ mvt.emplacement.id }}" selected>{{ mvt.emplacement.label }}</option>
            {% endif %}
        </select>
    </div>

    {% include 'mouvement_traca/trackingMovementQuantity.html.twig' with {
        quantity: mvt.quantity,
        containerClass: 'col-md-6'
    } %}
</div>

<span class="toggle-collapsible expanded">Champs libres</span>
<div class="collapsible expanded free-fields-container mb-2">
    {% include 'free_field/freeFieldsEdit.html.twig' with {
        freeFields: champsLibres,
        freeFieldValues: mvt.freeFields,
        colType: 'col-md-6 col-12',
        requiredType: 'requiredEdit',
        actionType: 'edit'
    } %}
</div>

<div class="row">
    <div class="form-group col-12 h-fit-content">
        <label for="commentaire">Commentaire</label>
        <input id="commentaire" class="commentaire form-control data" name="commentaire" type="hidden">
        <div class="editor-container-edit" value="{{ mvt.commentaire }}" data-wysiwyg>{{ mvt.commentaire|raw }}</div>

    </div>
    <div class="form-group col-12">
        <div>
            {% include 'attachment/attachment.html.twig' with {
                'isNew': false,
                attachments : mvt.attachments
            } %}
        </div>
    </div>
</div>
