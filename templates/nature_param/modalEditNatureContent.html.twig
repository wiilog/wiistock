<div class="row">
    <div class="form-group col-md-6 col-12 required d-none">
        <input type="text" class="form-control data needed" name="nature" required="" value="{{ nature.id }}">
    </div>

    <div class="form-group col-md-6 col-12">
        <label>Label*</label>
        <input type="text" class="data form-control needed" name="label" value="{{ nature.label }}">
    </div>
    <div class="form-group col-md-6 col-12">
        <label>Code*</label>
        <input type="text" class="data form-control needed" name="code" value="{{ nature.code }}">
    </div>
    <div class="form-group col-md-6 col-12">
        <label>Description</label>
        <input type="text" class="data form-control" name="description" value="{{ nature.description }}">
    </div>
    <div class="form-group col-md-6 col-12">
        <label>Quantité par défaut*</label>
        <input type="number" class="data form-control needed" name="quantity"
               value="{{ nature.defaultQuantity is defined ? nature.defaultQuantity : '' }}" min="0">
    </div>
    <div class="form-group col-md-6 col-12">
        <label>Couleur*</label>
        <input type="color" class="data form-control needed" name="color" value="{{ nature.color ? nature.color : '' }}">
    </div>
    <div class="form-group col-md-6 col-12">
        <label for="code">Préfixe</label>
        <input type="text" class="data form-control" name="prefix" value="{{ nature.prefix ? nature.prefix : '' }}">
    </div>
    <div class="form-group col-md-6 col-12">
        <label>Températures</label>
        <sup><img src="{{ asset('svg/reference_article/information.svg') }}"
                  alt="Icône information"
                  width="10px"
                  class="has-tooltip"
                  title="Valable uniquement sur les demandes de transport">
        </sup>
        <select name="allowedTemperatures" class="form-control data w-100" data-s2 multiple>
            {% for temperature in temperatures %}
                {% set selected = (temperature in nature.temperatureRanges ? 'selected') %}
                <option value="{{ temperature.id }}" {{ selected }}>{{ temperature.value }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="form-group col-12">
        <label>Synchronisation nomade ?</label>
        {% set checkedSync = nature.needsMobileSync ? 'checked' %}
        <label class="switch ml-3">
            <input class="checkbox data" type="checkbox" name="mobileSync" {{ checkedSync }}>
            <span class="slider round"></span>
        </label>
    </div>
    <div class="form-group col-12">
        <label>Affiché en création d'arrivage</label>
        {% set checkedDisplayed = nature.displayed ? 'checked' %}
        <label class="switch ml-3">
            <input class="checkbox data" type="checkbox" name="displayed" {{ checkedDisplayed }}>
            <span class="slider round"></span>
        </label>
    </div>
    <div class="form-group col-12">
        <label>Nature par défaut (acheminements)</label>
        {% set checkedDefaultForDispatch = nature.defaultForDispatch ? 'checked' %}
        <label class="switch ml-3">
            <input class="checkbox data" type="checkbox" name="defaultForDispatch" {{ checkedDefaultForDispatch }}>
            <span class="slider round"></span>
        </label>
    </div>

    <div class="form-group col-12 d-flex align-items-center">
        <label>Affichage sur les formulaires</label>
        {% set checked = nature.displayedOnForms ? 'checked' %}
        <label class="switch ml-2">
            <input class="checkbox data" type="checkbox" name="displayedOnForms" {{ checked }} onchange="toggleEntitiesContainer($(this))">
            <span class="slider round"></span>
        </label>
    </div>

    {% set hide = not nature.displayedOnForms ? 'd-none' %}
    <div class="col-12 entities-container {{ hide }}">
        {% for index, entity in constant('App\\Entity\\Nature::ENTITIES') %}
            {% set checked = index in nature.allowedForms|keys %}
            <div class="d-flex mb-1">
                <div class="form-group col-auto d-flex align-items-center mb-2">
                    <label class="font-size-mini pointer">
                        <input class="checkbox data-array mr-2" {{ checked ? 'checked' }}
                               type="checkbox" name="{{ index }}" data-identifier="{{ entity }}" onclick="toggleTypes($(this));">
                        {{ entity }}
                    </label>
                </div>
                {% if index != constant('App\\Entity\\Nature::ARRIVAL_CODE') %}
                    <div class="col-4 types-container form-group mb-0">
                        <label class="d-none">Types de {{ entity }}</label>
                        <select name="{{ index }}Types" class="data form-control w-100 {{ checked ? 'needed' }}" data-s2 {{ not checked ? 'disabled' }} multiple>
                            {% for type in (types[index] ?? []) %}
                                {% set selected = type['id'] in nature.allowedForms[index] ?? [] ? 'selected' %}
                                <option value="{{ type['id'] }}" {{ selected }}>{{ type['label'] }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="input-group-append col-3">
                        <button class="btn btn-primary select-all-types w-100" type="button" onclick="selectAllTypes($(this))">Tous les types</button>
                    </div>
                {% endif %}
            </div>
        {% endfor %}
    </div>
</div>
